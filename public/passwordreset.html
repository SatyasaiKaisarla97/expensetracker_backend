<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reset Password</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="./styles/login.css" />
  </head>
  <body>
    <div class="container">
      <h1>Password Reset</h1>
      <form id="resetPasswordForm">
        <input
          type="password"
          id="newPassword"
          placeholder="New Password"
          required
        />
        <input
          type="password"
          id="confirmPassword"
          placeholder="Confirm Password"
          required
        />
        <button type="submit">Reset Password</button>
      </form>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const resetPasswordForm = document.getElementById("resetPasswordForm");
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get("token");

        resetPasswordForm.addEventListener("submit", function (e) {
          e.preventDefault();

          const newPassword = document.getElementById("newPassword").value;
          const confirmPassword =
            document.getElementById("confirmPassword").value;

          if (newPassword !== confirmPassword) {
            alert("Passwords do not match.");
            return;
          }

          axios
            .post("/user/reset-password", {
              newPassword,
              token,
            })
            .then(function (response) {
              console.log(response);
              alert("Your password has been reset successfully.");
              window.location.href = "/login.html";
            })
            .catch(function (error) {
              console.error(error);
              if (error.response && error.response.data) {
                alert(error.response.data);
              } else {
                alert("An error occurred. Please try again later.");
              }
            });
        });
      });
    </script>
  </body>
</html>
